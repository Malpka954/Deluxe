<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate-key="gameTitle">Mega Kliker EXTREME</title>
    <style>
        /* --- Style CSS --- */
        /* (Style CSS - bez zmian od poprzedniej wersji) */
        body {
            font-family: sans-serif; display: flex; justify-content: center; align-items: flex-start;
            min-height: 100vh; background-color: #222; margin: 0; color: #eee;
            padding: 20px; box-sizing: border-box; transition: background-color 0.5s ease;
            overflow-y: scroll;
        }
        .game-container {
            background-color: rgba(51, 51, 51, 0.9); padding: 30px; border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3); text-align: center; width: 95%;
            max-width: 950px; margin-top: 20px; position: relative; border: 1px solid #555;
            transition: background-color 0.5s ease, border-color 0.5s ease;
        }
        .skin-default body { background-color: #222; } .skin-default .game-container { background-color: rgba(51, 51, 51, 0.9); border-color: #555; } .skin-default .click-button { background-color: #5cb85c; background-image: none; } .skin-default .click-button:hover { background-color: #4cae4c; }
        .skin-gold body { background: linear-gradient(to bottom right, #fffacd, #f1c40f); } .skin-gold .game-container { background-color: rgba(255, 255, 255, 0.85); border: 2px solid #f39c12; color: #333; } .skin-gold .click-button { background: linear-gradient(to bottom, #f1c40f, #e67e22); color: #fff; border: 2px solid #d35400; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); font-size: 2.2em; animation: gold-shimmer 5s infinite linear; } @keyframes gold-shimmer { 0%, 100% { box-shadow: 0 0 5px #f1c40f; } 50% { box-shadow: 0 0 15px #fffacd; } } .skin-gold .click-button:hover { background: linear-gradient(to bottom, #f39c12, #d35400); animation-play-state: paused;} .skin-gold h1, .skin-gold h2 { color: #a04000; } .skin-gold .score-area, .skin-gold .rebirth-info { color: #27ae60; } .skin-gold .building, .skin-gold .upgrade, .skin-gold .boost-option { background-color: #fef9e7; border-color: #f5cba7; color: #333;} .skin-gold .building h3, .skin-gold .upgrade h3, .skin-gold .boost-option h4 { color: #b9770e; } .skin-gold .building p, .skin-gold .upgrade p, .skin-gold .boost-option p { color: #795548; } .skin-gold button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton) { background-color: #f39c12; } .skin-gold button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton):hover:not(:disabled) { background-color: #e67e22; } .skin-gold button:disabled { background-color: #f5cba7; opacity: 0.7; } .skin-gold .language-selector button { background: #fef5e7; color: #b9770e; border-color: #f5cba7;} .skin-gold .language-selector button.active { background: #f39c12; color: #fff;}
        .skin-hacker body { background-color: #000; background-image: linear-gradient(rgba(0,255,0,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(0,255,0,0.1) 1px, transparent 1px); background-size: 20px 20px; animation: scanline 10s linear infinite; } @keyframes scanline { 0% { background-position: 0 0; } 100% { background-position: 0 100%; } } .skin-hacker .game-container { background-color: rgba(0, 10, 0, 0.85); border: 1px solid #0f0; box-shadow: 0 0 15px #0f0; } .skin-hacker h1, .skin-hacker h2 { color: #0f0; font-family: 'Courier New', Courier, monospace; text-shadow: 0 0 5px #0f0; } .skin-hacker .click-button { background-color: #111; border: 2px solid #0f0; color: #0f0; font-family: 'Courier New', Courier, monospace; font-size: 1.8em; text-shadow: 0 0 8px #0f0; } .skin-hacker .click-button:hover { background-color: #050; box-shadow: 0 0 10px #0f0; } .skin-hacker .score-area, .skin-hacker .rebirth-info { color: #0f0; font-family: 'Courier New', Courier, monospace;} .skin-hacker .building, .skin-hacker .upgrade, .skin-hacker .boost-option { background-color: #050805; border-color: #0a0; color: #0f0; font-family: 'Courier New', Courier, monospace;} .skin-hacker .building h3, .skin-hacker .upgrade h3, .skin-hacker .boost-option h4 { color: #3f3; } .skin-hacker .building p, .skin-hacker .upgrade p, .skin-hacker .boost-option p { color: #0c0; } .skin-hacker button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton) { background-color: #050; border: 1px solid #0f0; color: #0f0; } .skin-hacker button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton):hover:not(:disabled) { background-color: #080; box-shadow: 0 0 5px #0f0;} .skin-hacker button:disabled { background-color: #030; opacity: 0.7; } .skin-hacker .language-selector button { background: #030; color: #0f0; border-color: #0a0;} .skin-hacker .language-selector button.active { background: #0a0; color: #0f0;} .skin-hacker #console { background: #050805; border-color: #0f0;} .skin-hacker #console input, .skin-hacker #console button { background-color: #030; border-color: #0a0; color: #0f0;}
        .skin-space body { background: #000020 url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Cg fill="%23ffffff" fill-opacity="0.1"%3E%3Ccircle cx="50" cy="50" r="1"/%3E%3Ccircle cx="10" cy="10" r="1"/%3E%3Ccircle cx="90" cy="90" r="1"/%3E%3Ccircle cx="10" cy="90" r="0.5"/%3E%3Ccircle cx="90" cy="10" r="0.5"/%3E%3Ccircle cx="30" cy="70" r="0.7"/%3E%3Ccircle cx="70" cy="30" r="0.7"/%3E%3C/g%3E%3C/svg%3E'); animation: space-bg 120s linear infinite; } @keyframes space-bg { 0% { background-position: 0 0; } 100% { background-position: 1000px 1000px; } } .skin-space .game-container { background: linear-gradient(rgba(20, 0, 40, 0.8), rgba(0, 0, 20, 0.9)); border: 1px solid #7070ff; box-shadow: 0 0 15px #7070ff; } .skin-space h1, .skin-space h2 { color: #e0e0ff; text-shadow: 0 0 5px #a0a0ff; } .skin-space .click-button { background: radial-gradient(circle, #ffffff 0%, #aaaaff 50%, #5050cc 100%); color: #000030; border: 2px solid #a0a0ff; box-shadow: 0 0 15px #fff; font-weight: bold; animation: space-pulse 3s infinite ease-in-out; } @keyframes space-pulse { 0%, 100% { transform: scale(1); box-shadow: 0 0 15px #fff; } 50% { transform: scale(1.02); box-shadow: 0 0 25px #ccf; } } .skin-space .click-button:hover { box-shadow: 0 0 25px #fff, 0 0 10px #a0a0ff; animation-play-state: paused; } .skin-space .score-area, .skin-space .rebirth-info { color: #a0ffa0; } .skin-space .building, .skin-space .upgrade, .skin-space .boost-option { background-color: rgba(30, 30, 60, 0.8); border-color: #5050aa; } .skin-space .building h3, .skin-space .upgrade h3, .skin-space .boost-option h4 { color: #c0c0ff; } .skin-space button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton) { background-color: #404090; border-color: #7070ff; } .skin-space button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton):hover:not(:disabled) { background-color: #6060b0; } .skin-space button:disabled { background-color: #303060; opacity: 0.7; } .skin-space .language-selector button { background: #202040; color: #c0c0ff; border-color: #5050aa;} .skin-space .language-selector button.active { background: #6060b0; color: #fff;}
        .skin-lava body { background: linear-gradient(to bottom, #330000, #ff3300); } .skin-lava .game-container { background-color: rgba(40, 0, 0, 0.85); border: 2px solid #ff6600; box-shadow: 0 0 20px #ff3300, 0 0 40px #661100 inset; } .skin-lava h1, .skin-lava h2 { color: #ffcc66; text-shadow: 0 0 5px #ff6600; } .skin-lava .click-button { background: radial-gradient(circle, #ffcc00 0%, #ff6600 70%, #661100 100%); color: #fff; border: 2px solid #ff9933; text-shadow: 1px 1px 2px #000; animation: lava-pulse 2s infinite alternate; } @keyframes lava-pulse { 0% { box-shadow: 0 0 10px #ff6600; transform: scale(1); } 100% { box-shadow: 0 0 25px #ffcc00; transform: scale(1.01);} } .skin-lava .click-button:hover { animation-play-state: paused; } .skin-lava .score-area, .skin-lava .rebirth-info { color: #ff9900; } .skin-lava .building, .skin-lava .upgrade, .skin-lava .boost-option { background-color: rgba(60, 20, 0, 0.8); border-color: #cc5500; } .skin-lava .building h3, .skin-lava .upgrade h3, .skin-lava .boost-option h4 { color: #ffaa33; } .skin-lava button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton) { background-color: #dd6611; border-color: #ff9933; color: #fff; } .skin-lava button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton):hover:not(:disabled) { background-color: #ff8833; } .skin-lava button:disabled { background-color: #994400; opacity: 0.7; } .skin-lava .language-selector button { background: #662200; color: #ffcc66; border-color: #cc5500;} .skin-lava .language-selector button.active { background: #ff8833; color: #fff;}
        .skin-ice body { background: linear-gradient(to bottom, #e0f2f7, #b3e5fc); } .skin-ice .game-container { background-color: rgba(200, 230, 255, 0.85); border: 2px solid #64b5f6; box-shadow: 0 0 20px #bbdefb, 0 0 5px #fff inset; color: #01579b; } .skin-ice h1, .skin-ice h2 { color: #0277bd; text-shadow: 0 0 3px #81d4fa; } .skin-ice .click-button { background: radial-gradient(circle, #ffffff 20%, #bbdefb 70%, #64b5f6 100%); color: #01579b; border: 2px solid #90caf9; box-shadow: 0 0 10px #ffffff inset, 0 0 15px #e3f2fd; font-weight: bold; position:relative; overflow: hidden; } .skin-ice .click-button::before { content:""; position: absolute; top:-50%; left:-50%; width:200%; height:200%; background: conic-gradient(transparent, rgba(255,255,255,0.3), transparent 30%); animation: ice-rotate 4s linear infinite; } @keyframes ice-rotate { 100% { transform: rotate(360deg); } } .skin-ice .click-button:hover { box-shadow: 0 0 15px #ffffff inset, 0 0 25px #e3f2fd; animation-play-state: paused;} .skin-ice .score-area, .skin-ice .rebirth-info { color: #03a9f4; } .skin-ice .building, .skin-ice .upgrade, .skin-ice .boost-option { background-color: rgba(225, 245, 254, 0.8); border: 1px solid #90caf9; } .skin-ice .building h3, .skin-ice .upgrade h3, .skin-ice .boost-option h4 { color: #0288d1; } .skin-ice button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton) { background-color: #42a5f5; border-color: #90caf9; color: #fff; } .skin-ice button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton):hover:not(:disabled) { background-color: #2196f3; } .skin-ice button:disabled { background-color: #90caf9; opacity: 0.7; } .skin-ice .language-selector button { background: #e1f5fe; color: #0277bd; border-color: #b3e5fc;} .skin-ice .language-selector button.active { background: #2196f3; color: #fff;}
        .skin-nature body { background: linear-gradient(to bottom, #a5d6a7, #4caf50); } .skin-nature .game-container { background-color: rgba(200, 230, 200, 0.85); border: 2px solid #66bb6a; box-shadow: 0 0 20px #c8e6c9, 0 0 10px #388e3c inset; color: #1b5e20; } .skin-nature h1, .skin-nature h2 { color: #2e7d32; text-shadow: 1px 1px 2px #a5d6a7; } .skin-nature .click-button { background: radial-gradient(circle, #ffffff 10%, #a5d6a7 60%, #388e3c 100%); color: #1b5e20; border: 3px dashed #81c784; box-shadow: 0 0 10px #c8e6c9; font-family: 'Georgia', serif; font-size: 2.1em; animation: nature-grow 5s infinite ease-in-out; } @keyframes nature-grow { 0%, 100% { transform: scale(1); border-width: 3px; filter: brightness(1); } 50% { transform: scale(1.03); border-width: 4px; filter: brightness(1.1); } } .skin-nature .click-button:hover { box-shadow: 0 0 15px #c8e6c9; border-style: solid; animation-play-state: paused; } .skin-nature .score-area, .skin-nature .rebirth-info { color: #43a047; } .skin-nature .building, .skin-nature .upgrade, .skin-nature .boost-option { background-color: rgba(232, 245, 233, 0.8); border: 1px solid #a5d6a7; } .skin-nature .building h3, .skin-nature .upgrade h3, .skin-nature .boost-option h4 { color: #388e3c; } .skin-nature button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton) { background-color: #66bb6a; border-color: #a5d6a7; color: #fff; } .skin-nature button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton):hover:not(:disabled) { background-color: #4caf50; } .skin-nature button:disabled { background-color: #a5d6a7; opacity: 0.7; } .skin-nature .language-selector button { background: #e8f5e9; color: #2e7d32; border-color: #c8e6c9;} .skin-nature .language-selector button.active { background: #4caf50; color: #fff;}
        /* Ocean - Ulepszony */
        .skin-ocean body { background: linear-gradient(to bottom, #0077cc, #003366); background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='20' viewBox='0 0 100 20'%3E%3Cdefs%3E%3ClinearGradient id='a' x1='0' x2='0' y1='0' y2='1'%3E%3Cstop offset='0' stop-color='%230055aa'/%3E%3Cstop offset='1' stop-color='%230077cc'/%3E%3C/linearGradient%3E%3C/defs%3E%3Cpath fill='url(%23a)' d='M0 10 Q 25 20 50 10 T 100 10 V 20 H 0 Z' /%3E%3Cpath fill='rgba(255,255,255,0.1)' d='M0 15 Q 25 5 50 15 T 100 15 V 20 H 0 Z' /%3E%3C/svg%3E"), linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px); background-size: auto, 2px 2px; animation: ocean-bg 10s linear infinite, bubbles 5s linear infinite alternate; } @keyframes ocean-bg { 0% { background-position: 0 0, 0 0; } 100% { background-position: -200px 0, 0 0; } } @keyframes bubbles { 0% { background-position: 0 0, 0 0; } 100% { background-position: 0 0, 0 -50px; } } .skin-ocean .game-container { background-color: rgba(0, 80, 150, 0.9); border: 3px outset #33aaff; box-shadow: 0 0 20px #66ccff, 0 0 30px #0055aa inset; } .skin-ocean h1, .skin-ocean h2 { color: #ccffff; text-shadow: 0 0 5px #66ccff; } .skin-ocean .click-button { background: radial-gradient(circle, #ffffff 10%, #66ccff 60%, #0077cc 100%); color: #003366; border: 2px solid #99ddff; box-shadow: 0 0 10px #ffffff inset, 0 0 15px #ccffff; animation: ocean-wave 3s ease-in-out infinite alternate; } @keyframes ocean-wave { 0% { transform: translateY(0px) scale(1); } 50% { transform: translateY(-3px) scale(1.02); } 100% { transform: translateY(0px) scale(1); } } .skin-ocean .click-button:hover { animation-play-state: paused; } .skin-ocean .score-area, .skin-ocean .rebirth-info { color: #99ddff; } .skin-ocean .building, .skin-ocean .upgrade, .skin-ocean .boost-option { background-color: rgba(0, 100, 180, 0.85); border: 1px solid #66bbff; } .skin-ocean .building h3, .skin-ocean .upgrade h3, .skin-ocean .boost-option h4 { color: #ccffff; } .skin-ocean button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton) { background-color: #3399dd; border: 1px solid #99ddff; color: #fff; } .skin-ocean button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton):hover:not(:disabled) { background-color: #0077cc; } .skin-ocean button:disabled { background-color: #005588; opacity: 0.7; } .skin-ocean .language-selector button { background: #003366; color: #ccffff; border-color: #66bbff;} .skin-ocean .language-selector button.active { background: #0077cc; color: #fff;}
        /* Steampunk - Ulepszony */
        .skin-steampunk body { background-color: #8B4513; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAARKSURBVHhe7Z1diqwgDIXpdALdpdM9dJdNp7t0p3fYQ4ggJgmjA9Ifh3MHCCH+qOQVQQhhTLJEghQJUqQIEQghjEmWSI8XG/N67q69vr6eXq933M/7x/v7+91uN1r/9Xo9NzcXq9VarVar1+uh0+nQcrmM5osXq1+/DkPbtm3b/j8G+1aj0YhqNBqNRkOaptNutyiK4rouTdM0TTAYDLqu8/PzQafTwWDw8PBwzM9LkuDPz0/m5+err78us7OzHA4Hzc/P0zSNOI6dTqfYbDYajRRFsVgsovM8TdMERZFarcZisfj4+Ihisfj+/p6tra0kSQKBAAUEAgEIBAIBAQEUEAgEIBAIBAQEUEAgEAgEAQEUEAgEAQEUEAgEAgICCiAQCAQCgYCAAggEgUBAQAABBQIBAIFAQEABBQIBAIBAQEABBQIBAIBAICAAoIBEIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFBAIBEIBAQEABBQIBAIBAICAAggEgUBAQEABBQIBAIFAQEABBQIBAIFAQEABBQIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFBAIBEIBAQEABBQIBAIBAICAAggEgUBAQEABBQIBAIFAQEABBQIBAIFAQEABBQIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFBAIBEIBAQEABBQIBAIBAICAAggEgUBAQEABBQIBAIFAQEABBQIBAIFAQEABBQIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFBAIBEIBAQEABBQIBAIBAICAAggEgUBAQEABBQIBAIFAQEABBQIBAIFAQEABBQIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFBAIBEIBAQEABBQIBAIBAICAAggEgUBAQEABBQIBAIFAQEABBQIBAIFAQEABBQIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFBAIBEIBAQEABBQIBAIBAICAAggEgUBAQEABBQIBAIFAQEABBQIBAIFAQEABBQIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFBAIBEIBAQEABBQIBAIBAICAAggEgUBAQEABBQIBAIFAQEABBQIBAIFAQEABBQIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFBAIBEIBAQEABBQIBAIBAICAAggEgUBAQEABBQIBAIFAQEABBQIBAIFAQEABBQIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFBAIBEIBAQEABBQIBAIBAICAAggEgUBAQEABBQIBAIFAQEABBQIBAIFAQEABBQIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFBAIBEIBAQEABBQIBAIBAICAAggEgUBAQEABBQIBAIFAQEABBQIBAIFAQEABBQIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFBAIBEIBAQEABBQIBAIBAICAAggEgUBAQEABBQIBAIFAQEABBQIBAIFAQEABBQIBAIBAICAAoIBEIBAIBAQAFBAIBEIBAIBAQAFhFk3b8H9nZ2dnZ2fR+Xz379/D4XA4HA5BEHQ6nVqtljRN4zg+OTlJkvTr12/4xQtf/PjxIzs7+9Xr14vVavV6vVgsFovFYrFYmqYsy7qu67quSRIymUwul8vlcvPz8/v7+6urq7qut9vtoiharfZ+3i+0v9/v5+fn4+Pj0Wi0WCzOzs7quq7r+vLygnEcTdMsy7qum5ub6XT64uIiSRLbtgRBHMfhcLg3W65//+d7e/p/b+D7f/xPq337fWJ2d/w8AAAAASUVORK5CYII='); background-size: auto, 60px 60px; } .skin-steampunk .game-container { background-color: rgba(139, 69, 19, 0.9); border: 5px groove #a0522d; box-shadow: 0 0 10px #cd853f inset, 0 0 15px #8b4513, 0 0 30px #502900; color: #f4a460; } .skin-steampunk h1, .skin-steampunk h2 { color: #deb887; font-family: 'Times New Roman', Times, serif; text-shadow: 1px 1px 2px #502900; } .skin-steampunk .click-button { background: linear-gradient(135deg, #cd853f, #8b4513, #cd853f); color: #fff; border: 2px outset #a0522d; font-family: 'Copperplate', fantasy; text-shadow: 1px 1px 1px #442200; font-size: 2.1em; position: relative; } .skin-steampunk .click-button::after { content: "⚙"; position: absolute; bottom: 5px; right: 10px; font-size: 0.5em; opacity: 0.5; animation: gear-rotate 10s linear infinite; } @keyframes gear-rotate { to { transform: rotate(360deg); } } .skin-steampunk .click-button:hover { background: linear-gradient(135deg, #d2691e, #a0522d, #d2691e); filter: brightness(1.1); } .skin-steampunk .score-area, .skin-steampunk .rebirth-info { color: #daa520; } .skin-steampunk .building, .skin-steampunk .upgrade, .skin-steampunk .boost-option { background-color: rgba(160, 82, 45, 0.85); border: 1px dashed #cd853f; } .skin-steampunk .building h3, .skin-steampunk .upgrade h3, .skin-steampunk .boost-option h4 { color: #f4a460; } .skin-steampunk button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton) { background-color: #a0522d; border: 1px solid #cd853f; color: #fff; font-family: 'Times New Roman', serif;} .skin-steampunk button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton):hover:not(:disabled) { background-color: #8b4513; } .skin-steampunk button:disabled { background-color: #cd853f; opacity: 0.7; } .skin-steampunk .language-selector button { background: #8b4513; color: #f4a460; border-color: #a0522d;} .skin-steampunk .language-selector button.active { background: #d2691e; color: #fff;}
        /* Pustka - Ulepszony */
        .skin-void body { background-color: #000; animation: void-stars 20s linear infinite; } @keyframes void-stars { 0% { background-position: 0 0; } 100% { background-position: 0 -1000px; } } body.skin-void::before { content: ""; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(ellipse at center, rgba(75,0,130,0.3) 0%,rgba(0,0,0,0) 60%); z-index: -1; pointer-events: none; } .skin-void .game-container { background-color: rgba(10, 0, 10, 0.9); border: 2px solid #4b0082; box-shadow: 0 0 25px #8a2be2, 0 0 10px #dda0dd inset, 0 0 50px rgba(75,0,130,0.5); } .skin-void h1, .skin-void h2 { color: #dda0dd; text-shadow: 0 0 8px #9400d3; font-family: cursive; } .skin-void .click-button { background: radial-gradient(circle, #4b0082 0%, #000000 70%); color: #ffffff; border: 2px solid #9400d3; box-shadow: 0 0 15px #dda0dd, 0 0 30px #4b0082; animation: void-pulse 4s infinite, void-color-shift 10s infinite linear alternate; } @keyframes void-pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(0.98); opacity: 0.8; } } @keyframes void-color-shift { 0% { filter: hue-rotate(0deg) brightness(1); } 100% { filter: hue-rotate(45deg) brightness(1.2); } } .skin-void .click-button:hover { animation-play-state: paused; filter: brightness(1.5); } .skin-void .score-area, .skin-void .rebirth-info { color: #ba55d3; } .skin-void .building, .skin-void .upgrade, .skin-void .boost-option { background-color: rgba(30, 0, 30, 0.85); border: 1px solid #8a2be2; } .skin-void .building h3, .skin-void .upgrade h3, .skin-void .boost-option h4 { color: #dda0dd; } .skin-void button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton) { background-color: #8a2be2; border-color: #9400d3; color: #fff; } .skin-void button:not(.click-button):not(.lang-button):not(#closeHelpOverlayBtn):not(.skin-buy-button):not(.boost-activate-button):not(#rebirthButton):hover:not(:disabled) { background-color: #9932cc; box-shadow: 0 0 10px #dda0dd; } .skin-void button:disabled { background-color: #4b0082; opacity: 0.7; } .skin-void .language-selector button { background: #4b0082; color: #dda0dd; border-color: #8a2be2;} .skin-void .language-selector button.active { background: #9932cc; color: #fff;}


        /* Styl skórki */
        #skinsSection { margin-top: 30px; padding-top: 20px; border-top: 1px solid #555; } #skinsSelectionContainer { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; } .skin-option { border: 2px solid #777; padding: 10px 15px; border-radius: 5px; cursor: pointer; transition: all 0.3s; text-align: center; min-width: 120px; position: relative; background-color: rgba(85, 85, 85, 0.7); display: flex; flex-direction: column; justify-content: space-between; } .skin-option:hover { border-color: #aaa; transform: translateY(-3px); box-shadow: 0 4px 8px rgba(0,0,0,0.3); } .skin-option.active-skin { border-color: #00ff00; box-shadow: 0 0 8px rgba(0, 255, 0, 0.6); } .skin-option.locked { cursor: default; opacity: 0.7; background-color: rgba(50, 50, 50, 0.7); } .skin-option.locked:hover { transform: none; box-shadow: none; border-color: #777; } .skin-option h4 { margin: 0 0 5px 0; font-size: 1em; color: #fff; } .skin-option p { margin: 3px 0; font-size: 0.8em; color: #ccc; } .skin-option .skin-cost { font-size: 0.9em; font-weight: bold; color: #ffcc00; margin-top: 5px; } .skin-option .skin-effect { font-size: 0.8em; font-style: italic; color: #90ee90; margin-top: 5px; } .skin-buy-button { padding: 5px 10px; font-size: 0.9em; cursor: pointer; border: none; border-radius: 3px; background-color: #007bff; color: white; margin-top: 10px; transition: background-color 0.3s ease; } .skin-buy-button:hover:not(:disabled) { background-color: #0056b3; } .skin-buy-button:disabled { background-color: #777; cursor: not-allowed; opacity: 0.6; } .skin-select-button { display: none; }
        /* Style Boostów */
        #boostsSection { margin-top: 30px; padding-top: 20px; border-top: 1px solid #555; } #boostsListContainer { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; } .boost-option { border: 2px solid #f0ad4e; padding: 10px 15px; border-radius: 5px; transition: all 0.3s; text-align: center; min-width: 150px; position: relative; background-color: rgba(68, 52, 24, 0.7); display: flex; flex-direction: column; justify-content: space-between; } .boost-option:hover:not(.boost-active) { border-color: #eea236; transform: translateY(-3px); box-shadow: 0 4px 8px rgba(0,0,0,0.3); } .boost-option.boost-active { border-color: #46b8da; box-shadow: 0 0 10px #5bc0de; cursor: default; } .boost-option h4 { margin: 0 0 5px 0; font-size: 1em; color: #f0ad4e; } .boost-option p { margin: 3px 0; font-size: 0.8em; color: #eee; } .boost-option .boost-cost { font-size: 0.9em; font-weight: bold; color: #ffcc00; margin-top: 5px; } .boost-option .boost-duration { font-size: 0.8em; font-style: italic; color: #f7ecb5; margin-top: 5px; } .boost-activate-button { padding: 5px 10px; font-size: 0.9em; cursor: pointer; border: none; border-radius: 3px; background-color: #f0ad4e; color: white; margin-top: 10px; transition: background-color 0.3s ease; } .boost-activate-button:hover:not(:disabled) { background-color: #ec971f; } .boost-activate-button:disabled { background-color: #a17131; cursor: not-allowed; opacity: 0.6; } .boost-timer { font-size: 0.8em; color: #5bc0de; margin-top: 5px; font-weight: bold; }
        /* Reszta stylów */
        .language-selector { position: absolute; top: 10px; right: 10px; z-index: 10; } .language-selector button { background: #555; border: 1px solid #777; color: #eee; padding: 5px 10px; margin-left: 5px; border-radius: 3px; cursor: pointer; font-size: 0.9em; } .language-selector button.active { background: #007bff; font-weight: bold; }
        h1, h2 { color: #fff; margin-bottom: 15px; }
        .score-area { margin-bottom: 5px; font-size: 1.5em; color: #4CAF50; }
        .rebirth-info { font-size: 1em; color: #4CAF50; margin-bottom: 15px; } .rebirth-info span { font-weight: bold; }
        #scoreDisplay, #cpsDisplay { font-weight: bold; }
        .click-button { padding: 20px 40px; font-size: 2em; cursor: pointer; border: none; border-radius: 8px; color: white; margin-bottom: 30px; transition: background-color 0.3s ease, transform 0.1s ease, background-image 0.5s ease, box-shadow 0.3s ease, filter 0.3s ease; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); } .click-button:hover { background-color: #4cae4c; } .click-button:active { transform: scale(0.98); }
        .click-button.lucky-click-active { box-shadow: 0 0 20px gold, 0 0 30px yellow; border: 3px solid gold; filter: brightness(1.2); animation: lucky-pulse 0.5s infinite alternate !important; } @keyframes lucky-pulse { 0% { transform: scale(1); } 100% { transform: scale(1.03); } }
        .game-sections { display: flex; gap: 20px; margin-top: 20px; flex-wrap: wrap; }
        .upgrades-area, .buildings-area { flex: 1; min-width: 350px; border: 1px solid #555; border-radius: 8px; padding: 15px; background-color: rgba(68, 68, 68, 0.8); }
        .buildings-area h2, .upgrades-area h2 { margin-top: 0; border-bottom: 1px solid #555; padding-bottom: 10px; }
        .building, .upgrade { border: 1px solid #555; padding: 15px; margin-bottom: 10px; border-radius: 5px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; background-color: rgba(85, 85, 85, 0.9); transition: transform 0.2s ease; }
        .building:hover, .upgrade:hover { transform: translateY(-3px); }
        .building div, .upgrade div { flex-basis: 65%; text-align: left; } .building p, .upgrade p { margin: 5px 0; font-size: 0.9em; color: #ccc; } .building h3, .upgrade h3 { margin: 0 0 5px 0; font-size: 1.1em; color: #fff; }
        .building button, .upgrade button { padding: 10px 15px; font-size: 1em; cursor: pointer; border: none; border-radius: 5px; background-color: #007bff; color: white; transition: background-color 0.3s ease; flex-basis: 30%; text-align: center; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); }
        .building button.max-level, .upgrade button.max-level { background-color: #5bc0de; cursor: default; }
        .building button:hover:not(:disabled):not(.max-level), .upgrade button:hover:not(:disabled):not(.max-level) { background-color: #0056b3; }
        .building button:disabled:not(.max-level), .upgrade button:disabled:not(.max-level) { background-color: #777; cursor: not-allowed; opacity: 0.6; }
        .save-load-area { margin-top: 30px; border-top: 1px solid #555; padding-top: 20px; text-align: center; }
        .save-load-area button { padding: 10px 15px; margin: 5px; cursor: pointer; border: none; border-radius: 5px; background-color: #6c757d; color: white; transition: background-color 0.3s ease; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); } .save-load-area button:hover { background-color: #5a6268; }
        #resetGameButton { background-color: #dc3545; } #resetGameButton:hover { background-color: #c82333; }
        #rebirthButton { background-color: #9b59b6; color: white; font-weight: bold; } #rebirthButton:hover:not(:disabled) { background-color: #8e44ad; } #rebirthButton:disabled { background-color: #bdc3c7; cursor: not-allowed; opacity: 0.6; }
        .message-area { margin-top: 20px; min-height: 1.2em; font-weight: bold; } .message-area[style*="green"] { color: #4CAF50; } .message-area[style*="red"] { color: #f44336; } .message-area[style*="orange"] { color: #ff9800; } .message-area[style*="blue"] { color: #2196F3; } .message-area[style*="purple"] { color: #9c27b0; }
        #openConsoleButton { margin-top: 20px; padding: 10px 15px; background-color: #f0ad4e; color: white; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); } #openConsoleButton:hover { background-color: #ec971f; }
        #console { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #222; border: 2px solid #555; border-radius: 10px; padding: 30px; z-index: 1000; box-shadow: 0 0 20px rgba(0,0,0,0.7); color: #eee; text-align: center; max-width: 90%; width: 450px; } #console h2 { margin-top: 0; color: #fff; } #console input { padding: 10px; margin: 10px 0; border: 1px solid #555; border-radius: 5px; background: #444; color: #eee; width: calc(100% - 24px); font-size: 1em; } #console button { padding: 10px 15px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; background-color: #007bff; color: white; transition: background-color 0.3s ease; } #console button:hover { background-color: #0056b3; } #console button#closeConsoleBtn { background-color: #6c757d; } #console button#closeConsoleBtn:hover { background-color: #5a6268; } #consoleCommands { margin-top: 20px; border-top: 1px solid #555; padding-top: 15px; position: relative; } #consoleCommands p { font-size: 0.9em; text-align: left; white-space: pre-wrap; color: #ccc; } #consoleHelpOverlay { display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(30, 30, 30, 0.95); border: 1px solid #777; border-radius: 5px; padding: 20px; z-index: 1001; color: #eee; text-align: left; overflow-y: auto; } #consoleHelpOverlay h3 { margin-top: 0; color: #fff; } #consoleHelpOverlay pre { white-space: pre-wrap; word-wrap: break-word; font-size: 0.9em; color: #ccc; } #closeHelpOverlayBtn { position: absolute; top: 10px; right: 10px; background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; }
        #maxAllBtn { background-color: #d9534f; } #maxAllBtn:hover { background-color: #c9302c; }

    </style>
</head>
<body class="skin-default">

    <div class="game-container">

        <div class="language-selector">
            <button id="lang-pl" class="lang-button">PL</button>
            <button id="lang-en" class="lang-button">EN</button>
        </div>

        <h1 data-translate-key="gameTitle">Mega Kliker EXTREME</h1>

        <div class="score-area">
            <p><span data-translate-key="scoreLabel">Punkty</span>: <span id="scoreDisplay">0</span></p>
            <p><span data-translate-key="cpsLabel">Produkcja/s (CPS)</span>: <span id="cpsDisplay">0</span></p>
        </div>
        <div class="rebirth-info">
            <p>
                <span data-translate-key="rebirthCountLabel">Rebirthy</span>: <span id="rebirthCountDisplay">0</span> |
                <span data-translate-key="rebirthBonusLabel">Bonus CPS</span>: <span id="rebirthBonusDisplay">x1.00</span>
            </p>
        </div>

        <button id="clickButton" class="click-button" data-translate-key="clickButton">Kliknij Mnie!</button>

        <div class="game-sections">
            <div class="buildings-area">
                <h2 data-translate-key="buildingsHeader">Budynki</h2>
                <div id="buildingsList"></div>
            </div>
            <div class="upgrades-area">
                <h2 data-translate-key="upgradesHeader">Ulepszenia</h2>
                <div id="upgradesList"></div>
            </div>
        </div>

        <div id="boostsSection">
            <h2 data-translate-key="boostsHeader">Bonusy Czasowe</h2>
            <div id="boostsListContainer"></div>
        </div>

        <div id="skinsSection">
            <h2 data-translate-key="skinsHeader">Skórki</h2>
            <div id="skinsSelectionContainer"></div>
        </div>

        <div class="save-load-area">
            <button id="saveGameButton" data-translate-key="saveButton">Zapisz Grę</button>
            <button id="loadGameButton" data-translate-key="loadButton">Wczytaj Grę</button>
            <button id="resetGameButton" data-translate-key="resetButton">Resetuj Grę</button>
            <button id="rebirthButton" data-translate-key="rebirthButton" disabled>Rebirth</button>
        </div>

         <button id="openConsoleButton" data-translate-key="openConsoleButton">Konsola Admina</button>

        <div class="message-area" id="messageArea"></div>

         <div id="console">
             <h2 data-translate-key="consoleTitle">Konsola Admina</h2>
             <input type="password" id="consolePassword" data-translate-key="consolePasswordPlaceholder" placeholder="Wprowadź hasło...">
             <button id="consoleOpenBtn" data-translate-key="consoleOpenBtn">Otwórz</button>
             <button id="closeConsoleBtn" data-translate-key="consoleCloseBtn">Zamknij</button>
             <div id="consoleCommands">
                 <input type="text" id="commandInput" data-translate-key="consoleCommandPlaceholder" placeholder="Wpisz komendę (np. help)">
                 <button id="executeCommandBtn" data-translate-key="consoleExecuteBtn">Wykonaj</button>
                 <button id="maxAllBtn" data-translate-key="consoleMaxAllBtn">Ulepsz Wszystko</button>
                 <p data-translate-key="consoleHelpInfo">Wpisz 'help' aby zobaczyć dostępne komendy.</p>
                 <div id="consoleHelpOverlay">
                     <h3 data-translate-key="consoleHelpOverlayTitle">Pomoc Konsoli</h3>
                     <pre id="consoleHelpText"></pre>
                     <button id="closeHelpOverlayBtn" data-translate-key="consoleCloseHelpBtn">X</button>
                 </div>
             </div>
         </div>
    </div>

    <script>
        // --- Zmienne Globalne ---
        let score = 0;
        let clickPower = 1; // Base click power
        let passiveProduction = 0; // Calculated CPS
        let currentLanguage = 'pl';
        let currentSkinId = 'default';
        let rebirthCount = 0;
        let rebirthBonusCpsMultiplier = 1;
        let goldenClicksRemaining = 0;
        let currentGoldenClickMultiplier = 1;
        const MAX_OFFLINE_TIME_SECONDS = 8 * 60 * 60;
        const REBIRTH_BONUS_PER_LEVEL = 0.15; // +15% CPS per rebirth

        // --- Tłumaczenia ---
        const translations = {
             pl: {
                gameTitle: "Mega Kliker EXTREME", scoreLabel: "Punkty", cpsLabel: "Produkcja/s (CPS)", clickButton: "Kliknij Mnie!",
                buildingsHeader: "Budynki", upgradesHeader: "Ulepszenia", saveButton: "Zapisz Grę", loadButton: "Wczytaj Grę",
                resetButton: "Resetuj Grę", openConsoleButton: "Konsola Admina", skinsHeader: "Skórki", boostsHeader: "Bonusy Czasowe",
                rebirthButton: "Rebirth", rebirthCountLabel: "Rebirthy", rebirthBonusLabel: "Bonus CPS",
                // Skórki
                skin_default_name: "Domyślna", skin_default_desc: "Klasyczny wygląd",
                skin_gold_name: "Złota", skin_gold_desc: "Błyszczący luksus", skin_gold_effect: "+5% do CPS",
                skin_hacker_name: "Haker", skin_hacker_desc: "Zielony kod", skin_hacker_effect: "Kliknięcia +10%",
                skin_space_name: "Kosmiczna", skin_space_desc: "Między gwiazdami", skin_space_effect: "+8% CPS, +5% Klik.",
                skin_lava_name: "Lawa", skin_lava_desc: "Piekielny żar", skin_lava_effect: "+15% do CPS",
                skin_ice_name: "Lód", skin_ice_desc: "Mroźna potęga", skin_ice_effect: "Kliknięcia +20%",
                skin_nature_name: "Natura", skin_nature_desc: "Siła wzrostu", skin_nature_effect: "+0.02% CPS/Budynek",
                skin_ocean_name: "Ocean", skin_ocean_desc: "Głębinowa moc", skin_ocean_effect: "Koszt budynków -5%",
                skin_steampunk_name: "Steampunk", skin_steampunk_desc: "Mechaniczna precyzja", skin_steampunk_effect: "Bonus Rebirth +10%",
                skin_void_name: "Pustka", skin_void_desc: "Nicość pochłania", skin_void_effect: "Bonusy czasowe trwają +20%",
                // Bonusy Czasowe
                boost_doubleCps30s_name: "Podwójne CPS", boost_doubleCps30s_desc: "2x więcej CPS przez 30 sekund", boost_doubleCps30s_duration: "30s",
                boost_megaClick10s_name: "Mega Kliknięcie", boost_megaClick10s_desc: "10x siła kliknięcia przez 10 sekund", boost_megaClick10s_duration: "10s",
                boost_profitFrenzy_name: "Szał Zysków", boost_profitFrenzy_desc: "4x CPS i 4x Kliknięcia przez 15s", boost_profitFrenzy_duration: "15s",
                boost_luckyClick_name: "Szczęśliwe Kliknięcia", boost_luckyClick_desc: "Następne 7 kliknięć x777 mocy", boost_luckyClick_duration: "7 Klik.", boostRemainingClicksLabel: "kliknięć pozostało",
                // Budynki
                building_finger_name: "Szybki Palec", building_cursor_name: "Kursor Automatyczny", building_worker_name: "Pracownik", building_farm_name: "Mała Farma", building_mine_name: "Kopalnia", building_factory_name: "Fabryka", building_lab_name: "Laboratorium", building_temple_name: "Starożytna Świątynia", building_bank_name: "Bank Centralny", building_portal_name: "Portal Międzywymiarowy", building_galaxy_name: "Generator Galaktyk", building_universe_name: "Symulator Wszechświata",
                building_antimatter_name: "Kondensator Antymaterii", building_singularity_name: "Manipulator Osobliwości", building_omniverse_name: "Kuźnia Wszechświatów",
                // Ulepszenia
                upgrade_click1_name: "Wzmacniacz Kliknięcia I", upgrade_click2_name: "Wzmacniacz Kliknięcia II", upgrade_click3_name: "Wzmacniacz Kliknięcia III", upgrade_click4_name: "Wzm. Klik. IV (CPS)", upgrade_click5_name: "Wzm. Klik. V", upgrade_click6_name: "Wzm. Klik. VI",
                upgrade_workerBoost1_name: "Lepsze Narzędzia (Pracownik)", upgrade_workerBoost2_name: "Automatyzacja (Pracownik)", upgrade_workerBoost3_name: "Szkolenia (Pracownik)",
                upgrade_farmBoost1_name: "Nowe Nawozy (Farma)", upgrade_mineBoost1_name: "Głębsze Szyby (Kopalnia)", upgrade_factoryBoost1_name: "Linie Montażowe (Fabryka)",
                upgrade_labBoost1_name: "Szybsze Badania (Lab.)", upgrade_templeBoost1_name: "Więcej Reliktów (Świąt.)", upgrade_bankBoost1_name: "Wyższe Oprocentowanie (Bank)",
                upgrade_portalBoost1_name: "Stabilizacja Portali", upgrade_galaxyBoost1_name: "Mapowanie Galaktyk", upgrade_universeBoost1_name: "Optymalizacja Symulacji",
                upgrade_antimatterBoost1_name: "Kontrola Antymaterii", upgrade_singularityBoost1_name: "Stabilizacja Horyzontu", upgrade_omniverseBoost1_name: "Wzmocnienie Kuźni",
                upgrade_globalBoost1_name: "Globalna Optymalizacja", upgrade_globalBoost2_name: "Większa Wydajność", upgrade_globalBoost3_name: "Synergia Budynków", upgrade_globalBoost4_name: "Potęga Rebirthu",
                upgrade_costReduction1_name: "Negocjacje Handlowe", upgrade_costReduction2_name: "Ulgi Podatkowe",
                // Teksty UI
                buyButtonLabel: "Kup", amountLabel: "Ilość", costLabel: "Koszt", productionLabel: "Produkcja/s", effectLabel: "Efekt", levelLabel: "Poz.", maxLevelLabel: "MAX",
                skinBuyButtonLabel: "Kup Skórkę", boostActivateButtonLabel: "Aktywuj", boostActiveLabel: "Aktywny:",
                messageBoughtBuilding: "Kupiono {0}!", messageNotEnoughPoints: "Za mało punktów!", messageUpgradeBought: "Kupiono ulepszenie: {0}!",
                messageUpgradeUnavailable: "Ulepszenie niedostępne lub już kupione.", messageUpgradeRequirementsNotMet: "Wymagania ulepszenia nie są spełnione.",
                messageGameSaved: "Gra zapisana!", messageGameSavedAuto: "Gra zapisana automatycznie!", messageGameLoaded: "Gra wczytana!",
                messageNoSaveData: "Brak zapisanego stanu gry.", messageConfirmReset: "Czy na pewno chcesz zresetować grę? Stracisz cały postęp!",
                messageOfflineProgress: "W czasie Twojej nieobecności ({0}h {1}m {2}s) zarobiono {3} punktów!",
                messageSkinBought: "Odblokowano skórkę: {0}!", messageSkinSelected: "Wybrano skórkę: {0}!", messageSkinSelectLocked: "Ta skórka jest zablokowana!",
                messageBoostActivated: "Bonus '{0}' aktywny!", messageBoostAlreadyActive: "Bonus '{0}' jest już aktywny!", messageBoostInstant: "Bonus '{0}' użyty!",
                messageBuildingMaxLevel: "Budynek {0} osiągnął maksymalny poziom!",
                messageConfirmRebirth: "Czy na pewno chcesz wykonać Rebirth? Zresetujesz postęp (poza Rebirthami i skórkami), aby uzyskać stały bonus CPS!",
                messageRebirthComplete: "Rebirth wykonany! Zdobywasz +{0}% bonusu do CPS!",
                // Konsola
                consoleTitle: "Konsola Admina", consolePasswordPlaceholder: "Wprowadź hasło...", consoleOpenBtn: "Otwórz", consoleCloseBtn: "Zamknij",
                consoleCommandPlaceholder: "Wpisz komendę (np. help)", consoleExecuteBtn: "Wykonaj", consoleMaxAllBtn: "Ulepsz Wszystko",
                consoleHelpInfo: "Wpisz 'help' aby zobaczyć dostępne komendy.",
                consoleHelpOverlayTitle: "Pomoc Konsoli", consoleCloseHelpBtn: "Zamknij Pomoc", consoleUnlocked: "Konsola odblokowana.",
                consoleInvalidPassword: "Nieprawidłowe hasło konsoli.", consoleCmdAddedScore: "Dodano {0} punktów.", consoleCmdAddedBuilding: "Dodano {0} x {1}.",
                consoleCmdBuildingNotFound: "Nie znaleziono budynku o ID: \"{0}\".", consoleCmdUpgradeBought: "Kupiono ulepszenie: {0}.",
                consoleCmdUpgradeAlreadyBought: "Ulepszenie \"{0}\" już kupione.", consoleCmdUpgradeNotFound: "Nie znaleziono ulepszenia o ID: \"{0}\".",
                consoleCmdInvalidAdd: "Nieprawidłowa komenda 'add'. Użyj: add score [il] / add building [id] [il] / add upgrade [id]",
                consoleCmdScoreSet: "Ustawiono punkty na {0}.", consoleCmdInvalidSet: "Nieznana lub nieprawidłowa komenda 'set'. Użyj: set score [il]",
                consoleCmdHelp: "Dostępne komendy:\nadd score [il]\nadd building [id] [il]\nadd upgrade [id]\nset score [il]",
                consoleCmdUnknown: "Nieznana komenda: \"{0}\". Wpisz 'help'.", consoleCmdError: "Wystąpił błąd.",
                consoleMaxAllComplete: "Wszystkie ulepszenia kupione, budynki zmaksymalizowane i dodano punkty!",
            },
            en: { /* ... (Fill in English translations) ... */
                gameTitle: "Mega Clicker EXTREME", scoreLabel: "Score", cpsLabel: "Production/s (CPS)", clickButton: "Click Me!",
                buildingsHeader: "Buildings", upgradesHeader: "Upgrades", saveButton: "Save Game", loadButton: "Load Game",
                resetButton: "Reset Game", openConsoleButton: "Admin Console", skinsHeader: "Skins", boostsHeader: "Temporary Boosts",
                rebirthButton: "Rebirth", rebirthCountLabel: "Rebirths", rebirthBonusLabel: "CPS Bonus",
                 // Skins
                skin_default_name: "Default", skin_default_desc: "Classic look",
                skin_gold_name: "Golden", skin_gold_desc: "Shiny luxury", skin_gold_effect: "+5% CPS",
                skin_hacker_name: "Hacker", skin_hacker_desc: "Green code", skin_hacker_effect: "Clicks +10%",
                skin_space_name: "Cosmic", skin_space_desc: "Among the stars", skin_space_effect: "+8% CPS, +5% Clicks",
                skin_lava_name: "Lava", skin_lava_desc: "Infernal heat", skin_lava_effect: "+15% CPS",
                skin_ice_name: "Ice", skin_ice_desc: "Frigid power", skin_ice_effect: "Clicks +20%",
                skin_nature_name: "Nature", skin_nature_desc: "Power of growth", skin_nature_effect: "+0.02% CPS/Building",
                skin_ocean_name: "Ocean", skin_ocean_desc: "Depths' might", skin_ocean_effect: "Building cost -5%",
                skin_steampunk_name: "Steampunk", skin_steampunk_desc: "Mechanical precision", skin_steampunk_effect: "Rebirth Bonus +10%",
                skin_void_name: "Void", skin_void_desc: "Nothingness consumes", skin_void_effect: "Boost duration +20%",
                 // Boosts
                boost_doubleCps30s_name: "Double CPS", boost_doubleCps30s_desc: "2x more CPS for 30 seconds", boost_doubleCps30s_duration: "30s",
                boost_megaClick10s_name: "Mega Click", boost_megaClick10s_desc: "10x click power for 10 seconds", boost_megaClick10s_duration: "10s",
                boost_profitFrenzy_name: "Profit Frenzy", boost_profitFrenzy_desc: "4x CPS and 4x Clicks for 15s", boost_profitFrenzy_duration: "15s",
                boost_luckyClick_name: "Lucky Clicks", boost_luckyClick_desc: "Next 7 clicks x777 power", boost_luckyClick_duration: "7 Clicks", boostRemainingClicksLabel: "clicks remaining",
                 // Buildings
                building_finger_name: "Quick Finger", building_cursor_name: "Auto Cursor", building_worker_name: "Worker", building_farm_name: "Small Farm", building_mine_name: "Mine", building_factory_name: "Factory", building_lab_name: "Laboratory", building_temple_name: "Ancient Temple", building_bank_name: "Central Bank", building_portal_name: "Interdimensional Portal", building_galaxy_name: "Galaxy Generator", building_universe_name: "Universe Simulator",
                building_antimatter_name: "Antimatter Condenser", building_singularity_name: "Singularity Manipulator", building_omniverse_name: "Omniverse Forge",
                 // Upgrades
                upgrade_click1_name: "Click Booster I", upgrade_click2_name: "Click Booster II", upgrade_click3_name: "Click Booster III", upgrade_click4_name: "Click Amp. IV (CPS)", upgrade_click5_name: "Click Amp. V", upgrade_click6_name: "Click Amp. VI",
                upgrade_workerBoost1_name: "Better Tools (Worker)", upgrade_workerBoost2_name: "Automation (Worker)", upgrade_workerBoost3_name: "Training (Worker)",
                upgrade_farmBoost1_name: "New Fertilizers (Farm)", upgrade_mineBoost1_name: "Deeper Shafts (Mine)", upgrade_factoryBoost1_name: "Assembly Lines (Factory)",
                upgrade_labBoost1_name: "Faster Research (Lab)", upgrade_templeBoost1_name: "More Relics (Temple)", upgrade_bankBoost1_name: "Higher Interest (Bank)",
                upgrade_portalBoost1_name: "Portal Stabilization", upgrade_galaxyBoost1_name: "Galaxy Mapping", upgrade_universeBoost1_name: "Simulation Optimization",
                upgrade_antimatterBoost1_name: "Antimatter Containment", upgrade_singularityBoost1_name: "Horizon Stability", upgrade_omniverseBoost1_name: "Forge Enhancement",
                upgrade_globalBoost1_name: "Global Optimization", upgrade_globalBoost2_name: "Higher Efficiency", upgrade_globalBoost3_name: "Building Synergy", upgrade_globalBoost4_name: "Rebirth Power",
                upgrade_costReduction1_name: "Trade Negotiations", upgrade_costReduction2_name: "Tax Breaks",
                 // UI Texts
                buyButtonLabel: "Buy", amountLabel: "Amount", costLabel: "Cost", productionLabel: "Production/s", effectLabel: "Effect", levelLabel: "Lvl.", maxLevelLabel: "MAX",
                skinBuyButtonLabel: "Buy Skin", boostActivateButtonLabel: "Activate", boostActiveLabel: "Active:",
                messageBoughtBuilding: "Bought {0}!", messageNotEnoughPoints: "Not enough points!", messageUpgradeBought: "Upgrade purchased: {0}!",
                messageUpgradeUnavailable: "Upgrade unavailable or already bought.", messageUpgradeRequirementsNotMet: "Upgrade requirements not met.",
                messageGameSaved: "Game saved!", messageGameSavedAuto: "Game saved automatically!", messageGameLoaded: "Game loaded!",
                messageNoSaveData: "No saved game data found.", messageConfirmReset: "Are you sure you want to reset the game? All progress will be lost!",
                messageOfflineProgress: "While you were away ({0}h {1}m {2}s), you earned {3} points!",
                messageSkinBought: "Unlocked skin: {0}!", messageSkinSelected: "Selected skin: {0}!", messageSkinSelectLocked: "This skin is locked!",
                messageBoostActivated: "Boost '{0}' active!", messageBoostAlreadyActive: "Boost '{0}' is already active!", messageBoostInstant: "Boost '{0}' used!",
                messageBuildingMaxLevel: "Building {0} reached max level!",
                messageConfirmRebirth: "Are you sure you want to Rebirth? You will reset progress (except Rebirths & Skins) to gain a permanent CPS bonus!",
                messageRebirthComplete: "Rebirth complete! You gain a +{0}% CPS bonus!",
                 // Console
                consoleTitle: "Admin Console", consolePasswordPlaceholder: "Enter password...", consoleOpenBtn: "Open", consoleCloseBtn: "Close",
                consoleCommandPlaceholder: "Enter command (e.g., help)", consoleExecuteBtn: "Execute", consoleMaxAllBtn: "Max Everything",
                consoleHelpInfo: "Type 'help' to see available commands.",
                consoleHelpOverlayTitle: "Console Help", consoleCloseHelpBtn: "Close Help", consoleUnlocked: "Console unlocked.",
                consoleInvalidPassword: "Invalid console password.", consoleCmdAddedScore: "Added {0} points.", consoleCmdAddedBuilding: "Added {0} x {1}.",
                consoleCmdBuildingNotFound: "Building with ID \"{0}\" not found.", consoleCmdUpgradeBought: "Purchased upgrade: {0}.",
                consoleCmdUpgradeAlreadyBought: "Upgrade \"{0}\" already bought.", consoleCmdUpgradeNotFound: "Upgrade with ID \"{0}\" not found.",
                consoleCmdInvalidAdd: "Invalid 'add' command. Use: add score [amt] / add building [id] [amt] / add upgrade [id]",
                consoleCmdScoreSet: "Score set to {0}.", consoleCmdInvalidSet: "Unknown or invalid 'set' command. Use: set score [amt]",
                consoleCmdHelp: "Available commands:\nadd score [amt]\nadd building [id] [amt]\nadd upgrade [id]\nset score [amt]",
                consoleCmdUnknown: "Unknown command: \"{0}\". Type 'help'.", consoleCmdError: "An error occurred.",
                consoleMaxAllComplete: "All upgrades bought, buildings maxed, and score added!",
            }
        };

        // --- Definicje Danych Gry ---
        const buildingsData = [
             { id: 'finger', nameKey: 'building_finger_name', baseCost: 10, costMultiplier: 1.07, baseProduction: 0.05, count: 0, maxLevel: 1000 }, { id: 'cursor', nameKey: 'building_cursor_name', baseCost: 100, costMultiplier: 1.12, baseProduction: 0.5, count: 0, maxLevel: 1000 }, { id: 'worker', nameKey: 'building_worker_name', baseCost: 1100, costMultiplier: 1.15, baseProduction: 5, count: 0, maxLevel: 1000 }, { id: 'farm', nameKey: 'building_farm_name', baseCost: 12000, costMultiplier: 1.14, baseProduction: 25, count: 0, maxLevel: 1000 }, { id: 'mine', nameKey: 'building_mine_name', baseCost: 130000, costMultiplier: 1.13, baseProduction: 100, count: 0, maxLevel: 1000 }, { id: 'factory', nameKey: 'building_factory_name', baseCost: 1.4e6, costMultiplier: 1.12, baseProduction: 500, count: 0, maxLevel: 1000 }, { id: 'lab', nameKey: 'building_lab_name', baseCost: 2e7, costMultiplier: 1.11, baseProduction: 2500, count: 0, maxLevel: 1000 }, { id: 'temple', nameKey: 'building_temple_name', baseCost: 3.3e8, costMultiplier: 1.10, baseProduction: 15000, count: 0, maxLevel: 1000 }, { id: 'bank', nameKey: 'building_bank_name', baseCost: 5.1e9, costMultiplier: 1.09, baseProduction: 100000, count: 0, maxLevel: 1000 }, { id: 'portal', nameKey: 'building_portal_name', baseCost: 7.5e10, costMultiplier: 1.08, baseProduction: 1e6, count: 0, maxLevel: 1000 }, { id: 'galaxy', nameKey: 'building_galaxy_name', baseCost: 1e12, costMultiplier: 1.07, baseProduction: 1e7, count: 0, maxLevel: 1000 }, { id: 'universe', nameKey: 'building_universe_name', baseCost: 1.5e14, costMultiplier: 1.07, baseProduction: 1.5e8, count: 0, maxLevel: 1000 }, { id: 'antimatter', nameKey: 'building_antimatter_name', baseCost: 2.5e17, costMultiplier: 1.06, baseProduction: 2e9, count: 0, maxLevel: 1000 }, { id: 'singularity', nameKey: 'building_singularity_name', baseCost: 4e21, costMultiplier: 1.06, baseProduction: 3e11, count: 0, maxLevel: 1000 }, { id: 'omniverse', nameKey: 'building_omniverse_name', baseCost: 7e26, costMultiplier: 1.05, baseProduction: 5e14, count: 0, maxLevel: 1000 },
        ];
        const upgradesData = [
            { id: 'click1', nameKey: 'upgrade_click1_name', cost: 50, effect: { type: 'clickPowerMultiplier', value: 2 }, isBought: false }, { id: 'click2', nameKey: 'upgrade_click2_name', cost: 500, effect: { type: 'clickPowerMultiplier', value: 2 }, isBought: false, requires: { type: 'upgrade', id: 'click1' } }, { id: 'click3', nameKey: 'upgrade_click3_name', cost: 5000, effect: { type: 'clickPowerMultiplier', value: 2 }, isBought: false, requires: { type: 'upgrade', id: 'click2' } }, { id: 'click4', nameKey: 'upgrade_click4_name', cost: 1e5, effect: { type: 'clickPowerFromCps', value: 0.001 }, isBought: false, requires: { type: 'upgrade', id: 'click3'} }, { id: 'click5', nameKey: 'upgrade_click5_name', cost: 1e7, effect: { type: 'clickPowerMultiplier', value: 5 }, isBought: false, requires: { type: 'upgrade', id: 'click4'} }, { id: 'click6', nameKey: 'upgrade_click6_name', cost: 1e10, effect: { type: 'clickPowerMultiplier', value: 10 }, isBought: false, requires: { type: 'upgrade', id: 'click5'} },
            { id: 'workerBoost1', nameKey: 'upgrade_workerBoost1_name', cost: 1000, effect: { type: 'buildingProductionMultiplier', affectedId: 'worker', value: 2 }, isBought: false, requires: { type: 'buildingCount', id: 'worker', count: 5 } }, { id: 'workerBoost2', nameKey: 'upgrade_workerBoost2_name', cost: 5000, effect: { type: 'buildingProductionMultiplier', affectedId: 'worker', value: 3 }, isBought: false, requires: { type: 'buildingCount', id: 'worker', count: 25 } }, { id: 'workerBoost3', nameKey: 'upgrade_workerBoost3_name', cost: 1e6, effect: { type: 'buildingProductionMultiplier', affectedId: 'worker', value: 5 }, isBought: false, requires: { type: 'buildingCount', id: 'worker', count: 100 } },
            { id: 'farmBoost1', nameKey: 'upgrade_farmBoost1_name', cost: 10000, effect: { type: 'buildingProductionMultiplier', affectedId: 'farm', value: 2 }, isBought: false, requires: { type: 'buildingCount', id: 'farm', count: 5 } },
            { id: 'mineBoost1', nameKey: 'upgrade_mineBoost1_name', cost: 1.2e5, effect: { type: 'buildingProductionMultiplier', affectedId: 'mine', value: 2 }, isBought: false, requires: { type: 'buildingCount', id: 'mine', count: 10 } },
            { id: 'factoryBoost1', nameKey: 'upgrade_factoryBoost1_name', cost: 1.5e6, effect: { type: 'buildingProductionMultiplier', affectedId: 'factory', value: 2 }, isBought: false, requires: { type: 'buildingCount', id: 'factory', count: 15 } },
            { id: 'labBoost1', nameKey: 'upgrade_labBoost1_name', cost: 2.5e7, effect: { type: 'buildingProductionMultiplier', affectedId: 'lab', value: 2 }, isBought: false, requires: { type: 'buildingCount', id: 'lab', count: 20 } },
            { id: 'templeBoost1', nameKey: 'upgrade_templeBoost1_name', cost: 4e8, effect: { type: 'buildingProductionMultiplier', affectedId: 'temple', value: 2 }, isBought: false, requires: { type: 'buildingCount', id: 'temple', count: 25 } },
            { id: 'bankBoost1', nameKey: 'upgrade_bankBoost1_name', cost: 6e9, effect: { type: 'buildingProductionMultiplier', affectedId: 'bank', value: 2 }, isBought: false, requires: { type: 'buildingCount', id: 'bank', count: 30 } },
            { id: 'portalBoost1', nameKey: 'upgrade_portalBoost1_name', cost: 1e11, effect: { type: 'buildingProductionMultiplier', affectedId: 'portal', value: 3 }, isBought: false, requires: { type: 'buildingCount', id: 'portal', count: 50 } },
            { id: 'galaxyBoost1', nameKey: 'upgrade_galaxyBoost1_name', cost: 1.5e12, effect: { type: 'buildingProductionMultiplier', affectedId: 'galaxy', value: 3 }, isBought: false, requires: { type: 'buildingCount', id: 'galaxy', count: 75 } },
            { id: 'universeBoost1', nameKey: 'upgrade_universeBoost1_name', cost: 2e14, effect: { type: 'buildingProductionMultiplier', affectedId: 'universe', value: 3 }, isBought: false, requires: { type: 'buildingCount', id: 'universe', count: 100 } },
            { id: 'antimatterBoost1', nameKey: 'upgrade_antimatterBoost1_name', cost: 3e17, effect: { type: 'buildingProductionMultiplier', affectedId: 'antimatter', value: 4 }, isBought: false, requires: { type: 'buildingCount', id: 'antimatter', count: 150 } },
            { id: 'singularityBoost1', nameKey: 'upgrade_singularityBoost1_name', cost: 5e21, effect: { type: 'buildingProductionMultiplier', affectedId: 'singularity', value: 5 }, isBought: false, requires: { type: 'buildingCount', id: 'singularity', count: 200 } },
            { id: 'omniverseBoost1', nameKey: 'upgrade_omniverseBoost1_name', cost: 1e27, effect: { type: 'buildingProductionMultiplier', affectedId: 'omniverse', value: 10 }, isBought: false, requires: { type: 'buildingCount', id: 'omniverse', count: 250 } },
            { id: 'globalBoost1', nameKey: 'upgrade_globalBoost1_name', cost: 50000, effect: { type: 'allProductionMultiplier', value: 1.1 }, isBought: false, requires: { type: 'totalCPS', value: 100 } },
            { id: 'globalBoost2', nameKey: 'upgrade_globalBoost2_name', cost: 500000, effect: { type: 'allProductionMultiplier', value: 1.2 }, isBought: false, requires: { type: 'totalCPS', value: 1000 } },
            { id: 'globalBoost3', nameKey: 'upgrade_globalBoost3_name', cost: 1e9, effect: { type: 'allProductionMultiplier', value: 1.001, perBuildingType: true }, isBought: false, requires: { type: 'totalBuildings', value: 500 } },
            { id: 'globalBoost4', nameKey: 'upgrade_globalBoost4_name', cost: 1e15, effect: { type: 'allProductionMultiplier', value: 1.01, perRebirth: true }, isBought: false, requires: { type: 'rebirthCount', value: 1 } },
            { id: 'costReduction1', nameKey: 'upgrade_costReduction1_name', cost: 1e10, effect: { type: 'costReduction', value: 0.05 }, isBought: false, requires: { type: 'totalCPS', value: 1e7 } },
            { id: 'costReduction2', nameKey: 'upgrade_costReduction2_name', cost: 1e18, effect: { type: 'costReduction', value: 0.10 }, isBought: false, requires: { type: 'upgrade', id: 'costReduction1'} },
        ];
        const skinsData = [
            { id: 'default', nameKey: 'skin_default_name', descKey: 'skin_default_desc', cssClass: 'skin-default', cost: null, isUnlocked: true, effect: null, effectKey: null }, { id: 'gold', nameKey: 'skin_gold_name', descKey: 'skin_gold_desc', cssClass: 'skin-gold', cost: 1e6, isUnlocked: false, effect: { type: 'cpsMultiplier', value: 1.05 }, effectKey: 'skin_gold_effect' }, { id: 'hacker', nameKey: 'skin_hacker_name', descKey: 'skin_hacker_desc', cssClass: 'skin-hacker', cost: 5e6, isUnlocked: false, effect: { type: 'clickMultiplier', value: 1.10 }, effectKey: 'skin_hacker_effect' }, { id: 'space', nameKey: 'skin_space_name', descKey: 'skin_space_desc', cssClass: 'skin-space', cost: 25e6, isUnlocked: false, effect: { type: 'multi', cpsValue: 1.08, clickValue: 1.05 }, effectKey: 'skin_space_effect' }, { id: 'lava', nameKey: 'skin_lava_name', descKey: 'skin_lava_desc', cssClass: 'skin-lava', cost: 1e8, isUnlocked: false, effect: { type: 'cpsMultiplier', value: 1.15 }, effectKey: 'skin_lava_effect' }, { id: 'ice', nameKey: 'skin_ice_name', descKey: 'skin_ice_desc', cssClass: 'skin-ice', cost: 5e8, isUnlocked: false, effect: { type: 'clickMultiplier', value: 1.20 }, effectKey: 'skin_ice_effect' }, { id: 'nature', nameKey: 'skin_nature_name', descKey: 'skin_nature_desc', cssClass: 'skin-nature', cost: 1e9, isUnlocked: false, effect: { type: 'cpsPerBuildingCount', value: 0.0002 }, effectKey: 'skin_nature_effect' }, { id: 'ocean', nameKey: 'skin_ocean_name', descKey: 'skin_ocean_desc', cssClass: 'skin-ocean', cost: 2.5e9, isUnlocked: false, effect: { type: 'buildingCostReduction', value: 0.05 }, effectKey: 'skin_ocean_effect' }, { id: 'steampunk', nameKey: 'skin_steampunk_name', descKey: 'skin_steampunk_desc', cssClass: 'skin-steampunk', cost: 1.5e10, isUnlocked: false, effect: { type: 'rebirthBonusBoost', value: 1.10 }, effectKey: 'skin_steampunk_effect' }, { id: 'void', nameKey: 'skin_void_name', descKey: 'skin_void_desc', cssClass: 'skin-void', cost: 7.5e10, isUnlocked: false, effect: { type: 'boostDurationMultiplier', value: 1.20 }, effectKey: 'skin_void_effect' },
        ];
        const boostsData = [
            { id: 'doubleCps30s', nameKey: 'boost_doubleCps30s_name', descKey: 'boost_doubleCps30s_desc', durationKey: 'boost_doubleCps30s_duration', costType: 'fixed', cost: 50000, duration: 30000, effect: { type: 'tempCpsMultiplier', value: 2 }, isActive: false, timeoutId: null, remainingTime: 0 },
            { id: 'megaClick10s', nameKey: 'boost_megaClick10s_name', descKey: 'boost_megaClick10s_desc', durationKey: 'boost_megaClick10s_duration', costType: 'fixed', cost: 75000, duration: 10000, effect: { type: 'tempClickMultiplier', value: 10 }, isActive: false, timeoutId: null, remainingTime: 0 },
            { id: 'profitFrenzy', nameKey: 'boost_profitFrenzy_name', descKey: 'boost_profitFrenzy_desc', durationKey: 'boost_profitFrenzy_duration', costType: 'fixed', cost: 200000, duration: 15000, effect: { type: 'tempMulti', cpsValue: 4, clickValue: 4 }, isActive: false, timeoutId: null, remainingTime: 0 },
            { id: 'luckyClick', nameKey: 'boost_luckyClick_name', descKey: 'boost_luckyClick_desc', durationKey: 'boost_luckyClick_duration', costType: 'fixed', cost: 1000000, duration: 0, effect: { type: 'goldenClicks', count: 7, multiplier: 777 }, isActive: false /* isActive nieużywane dla tego typu */ },
        ];

        // --- Pobieranie Elementów DOM ---
        // (bez zmian)
        let scoreDisplay, cpsDisplay, clickButton, buildingsListDiv, upgradesListDiv, saveGameButton, loadGameButton, resetButton, messageArea, rebirthButton, rebirthCountDisplay, rebirthBonusDisplay, openConsoleButton, consoleDiv, consolePasswordInput, consoleOpenBtn, consoleCommandsDiv, commandInput, executeCommandBtn, closeConsoleBtn, maxAllBtn, consoleHelpOverlay, consoleHelpText, closeHelpOverlayBtn, skinsSelectionContainer, boostsListContainer;
        const adminPassword = "kupa";
        function cacheDOMElements() { scoreDisplay = document.getElementById('scoreDisplay'); cpsDisplay = document.getElementById('cpsDisplay'); clickButton = document.getElementById('clickButton'); buildingsListDiv = document.getElementById('buildingsList'); upgradesListDiv = document.getElementById('upgradesList'); saveGameButton = document.getElementById('saveGameButton'); loadGameButton = document.getElementById('loadGameButton'); resetButton = document.getElementById('resetGameButton'); messageArea = document.getElementById('messageArea'); rebirthButton = document.getElementById('rebirthButton'); rebirthCountDisplay = document.getElementById('rebirthCountDisplay'); rebirthBonusDisplay = document.getElementById('rebirthBonusDisplay'); openConsoleButton = document.getElementById('openConsoleButton'); consoleDiv = document.getElementById('console'); consolePasswordInput = document.getElementById('consolePassword'); consoleOpenBtn = document.getElementById('consoleOpenBtn'); consoleCommandsDiv = document.getElementById('consoleCommands'); commandInput = document.getElementById('commandInput'); executeCommandBtn = document.getElementById('executeCommandBtn'); closeConsoleBtn = document.getElementById('closeConsoleBtn'); maxAllBtn = document.getElementById('maxAllBtn'); consoleHelpOverlay = document.getElementById('consoleHelpOverlay'); consoleHelpText = document.getElementById('consoleHelpText'); closeHelpOverlayBtn = document.getElementById('closeHelpOverlayBtn'); skinsSelectionContainer = document.getElementById('skinsSelectionContainer'); boostsListContainer = document.getElementById('boostsListContainer'); }

        // --- Funkcje Pomocnicze ---
        // (bez zmian)
        function _(key, ...args) { let text = translations[currentLanguage]?.[key] || translations['en']?.[key] || key; if (args.length > 0) { args.forEach((arg, i) => { text = text.replace(`{${i}}`, arg ?? ''); }); } return text; }
        function formatNumber(num) { if (num === Infinity) return "Infinity"; const locale = currentLanguage === 'pl' ? 'pl-PL' : 'en-US'; if (num < 1000) { return parseFloat(num.toFixed(1)).toLocaleString(locale, { minimumFractionDigits: 1, maximumFractionDigits: 1 }); } const sfx = ["", " K", " M", " B", " T", " Qa", " Qi", " Sx", " Sp", " Oc", " No", " De", " UnD", " DuD", " TrD", " QaD", " QiD", " SxD", " SpD", " OcD", " NoD", " Vi", "Ce", "UnCe"]; const base = 1000; if (num >= base ** sfx.length) { return num.toExponential(2).replace('+', ''); } const exp = Math.floor(Math.log10(num) / 3); const val = num / (base ** exp); return val.toLocaleString(locale, { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + sfx[exp]; }
        function checkRequirements(upgrade) { if (!upgrade.requires) return true; const req = upgrade.requires; switch (req.type) { case 'buildingCount': const b = buildingsData.find(x => x.id === req.id); return b && b.count >= req.count; case 'totalCPS': return calculateTotalCPS(false, false) >= req.value; case 'totalBuildings': return buildingsData.reduce((sum, b) => sum + b.count, 0) >= req.value; case 'upgrade': const u = upgradesData.find(x => x.id === req.id); return u && u.isBought; case 'rebirthCount': return rebirthCount >= req.value; default: return false; } }
        function formatOfflineTime(totalSeconds) { const hours = Math.floor(totalSeconds / 3600); const minutes = Math.floor((totalSeconds % 3600) / 60); const seconds = Math.floor(totalSeconds % 60); return { hours, minutes, seconds }; }
        function formatRemainingTime(ms) { if (ms <= 0) return "0s"; return `${Math.ceil(ms / 1000)}s`; }
        function canRebirth() { return buildingsData.every(building => building.count >= building.maxLevel); }
        function calculateRebirthBonusMultiplier() { let multiplier = 1 + rebirthCount * REBIRTH_BONUS_PER_LEVEL; const activeSkin = skinsData.find(s => s.id === currentSkinId); if (activeSkin?.effect?.type === 'rebirthBonusBoost') { multiplier = 1 + (multiplier - 1) * activeSkin.effect.value; } return multiplier; }

        // --- Funkcje Gry (Logika) ---
        // (getBuildingProduction - bez zmian)
        function getBuildingCost(b) { if (b.count >= b.maxLevel) return Infinity; let cost = b.baseCost * (b.costMultiplier ** b.count); const activeSkin = skinsData.find(s => s.id === currentSkinId); if (activeSkin?.effect?.type === 'buildingCostReduction') { cost *= (1 - activeSkin.effect.value); } upgradesData.filter(u => u.isBought && u.effect.type === 'costReduction').forEach(u => { cost *= (1 - u.effect.value); }); return cost; }
        function getBuildingProduction(b) { let prod = b.count * b.baseProduction; upgradesData.filter(u => u.isBought && u.effect.type === 'buildingProductionMultiplier' && u.effect.affectedId === b.id).forEach(u => prod *= u.effect.value); return prod; }
        function calculateTotalCPS(includeSkinEffect = true, includeBoostEffect = true) { let total = 0; buildingsData.forEach(b => total += getBuildingProduction(b)); upgradesData.filter(u => u.isBought && u.effect.type === 'allProductionMultiplier').forEach(u => { if (u.effect.perBuildingType) { const ownedTypes = buildingsData.filter(b => b.count > 0).length; total *= (1 + (u.effect.value - 1) * ownedTypes); } else if (u.effect.perRebirth) { total *= (1 + (u.effect.value - 1) * rebirthCount); } else { total *= u.effect.value; } }); if (includeSkinEffect) { const activeSkin = skinsData.find(s => s.id === currentSkinId); if (activeSkin && activeSkin.effect) { if (activeSkin.effect.type === 'cpsMultiplier') total *= activeSkin.effect.value; else if (activeSkin.effect.type === 'multi' && activeSkin.effect.cpsValue) total *= activeSkin.effect.cpsValue; else if (activeSkin.effect.type === 'cpsPerBuildingCount') { const totalBuildings = buildingsData.reduce((sum, building) => sum + building.count, 0); total *= (1 + totalBuildings * activeSkin.effect.value); } } } if(includeBoostEffect) { boostsData.forEach(boost => { if (boost.isActive && boost.effect) { if (boost.effect.type === 'tempCpsMultiplier') total *= boost.effect.value; else if (boost.effect.type === 'tempMulti' && boost.effect.cpsValue) total *= boost.effect.cpsValue; } }); } total *= rebirthBonusCpsMultiplier; return total; }
        function getClickPower(includeSkinEffect = true, includeBoostEffect = true) { let power = clickPower; upgradesData.filter(u => u.isBought && u.effect.type === 'clickPowerMultiplier').forEach(u => power *= u.effect.value); upgradesData.filter(u => u.isBought && u.effect.type === 'clickPowerFromCps').forEach(u => { power += calculateTotalCPS(true, true) * u.effect.value; }); if (includeSkinEffect) { const activeSkin = skinsData.find(s => s.id === currentSkinId); if (activeSkin && activeSkin.effect) { if (activeSkin.effect.type === 'clickMultiplier') power *= activeSkin.effect.value; else if (activeSkin.effect.type === 'multi' && activeSkin.effect.clickValue) power *= activeSkin.effect.clickValue; } } if(includeBoostEffect) { boostsData.forEach(boost => { if (boost.isActive && boost.effect) { if (boost.effect.type === 'tempClickMultiplier') power *= boost.effect.value; else if (boost.effect.type === 'tempMulti' && boost.effect.clickValue) power *= boost.effect.clickValue; } }); } return power; }
        function click() {
            let clickValue = getClickPower(); let usedLuckyClick = false;
            if (goldenClicksRemaining > 0) {
                clickValue *= currentGoldenClickMultiplier;
                goldenClicksRemaining--;
                usedLuckyClick = true;
                if (goldenClicksRemaining === 0) { // Resetuj mnożnik i wygląd *po* ostatnim kliknięciu
                    currentGoldenClickMultiplier = 1;
                    console.log("Lucky Clicks finished.");
                }
            }
            score += clickValue;
            if (usedLuckyClick) { updateClickButtonAppearance(); renderBoosts(); } // Renderuj bonusy aby zaktualizować licznik kliknięć
            updateDisplay();
        }
        function buyBuilding(id) { const b = buildingsData.find(x => x.id === id); if (!b) return; if (b.count >= b.maxLevel) { showMessage('messageBuildingMaxLevel', 'orange', true, _(b.nameKey)); return; } const cost = getBuildingCost(b); if (score >= cost) { score -= cost; b.count++; if (b.count >= b.maxLevel) { showMessage('messageBuildingMaxLevel', 'green', true, _(b.nameKey)); } updateDisplay(); saveGame(); } else { showMessage('messageNotEnoughPoints', 'red'); } }
        function buyUpgrade(id) { const u = upgradesData.find(x => x.id === id); if (!u || u.isBought) { showMessage('messageUpgradeUnavailable', 'orange'); return; } if (!checkRequirements(u)) { showMessage('messageUpgradeRequirementsNotMet', 'orange'); return; } if (score >= u.cost) { score -= u.cost; u.isBought = true; showMessage('messageUpgradeBought', 'green', true, _(u.nameKey)); updateDisplay(); saveGame(); } else { showMessage('messageNotEnoughPoints', 'red'); } }
        function buySkin(skinId) { const skin = skinsData.find(s => s.id === skinId); if (!skin || skin.isUnlocked || !skin.cost) { return; } if (score >= skin.cost) { score -= skin.cost; skin.isUnlocked = true; showMessage('messageSkinBought', 'green', true, _(skin.nameKey)); renderSkins(); updateDisplay(); saveGame(); } else { showMessage('messageNotEnoughPoints', 'red'); } }

        // --- Funkcje Bonusów Czasowych ---
        function getBoostCost(boost) { if (boost.costType === 'cpsBased') { const baseCps = calculateTotalCPS(true, false); return baseCps > 0 ? baseCps * boost.costParam : 1; } return boost.cost; }
        function activateBoost(boostId) {
            const boost = boostsData.find(b => b.id === boostId); if (!boost) return;
            const currentCost = getBoostCost(boost);

            // Lucky Click Logic
            if (boost.effect?.type === 'goldenClicks') {
                if (goldenClicksRemaining > 0) { showMessage('messageBoostAlreadyActive', 'orange', true, _(boost.nameKey)); return; }
                if (score >= currentCost) {
                    score -= currentCost;
                    goldenClicksRemaining = boost.effect.count;
                    currentGoldenClickMultiplier = boost.effect.multiplier;
                    showMessage('messageBoostActivated', 'green', true, _(boost.nameKey));
                    renderBoosts(); updateDisplay(); updateClickButtonAppearance();
                } else { showMessage('messageNotEnoughPoints', 'red'); }
                return;
            }

            // Timed Boost Logic
            if (boost.isActive) { showMessage('messageBoostAlreadyActive', 'orange', true, _(boost.nameKey)); return; }
            if (score >= currentCost) {
                score -= currentCost; boost.isActive = true;
                let duration = boost.duration; const activeSkin = skinsData.find(s => s.id === currentSkinId);
                if (activeSkin?.effect?.type === 'boostDurationMultiplier') { duration *= activeSkin.effect.value; }
                boost.remainingTime = duration; if (boost.timeoutId) clearTimeout(boost.timeoutId);
                boost.timeoutId = setTimeout(() => { deactivateBoost(boostId); }, duration);
                showMessage('messageBoostActivated', 'green', true, _(boost.nameKey));
                renderBoosts(); updateDisplay();
            } else { showMessage('messageNotEnoughPoints', 'red'); }
        }
        function deactivateBoost(boostId) { const boost = boostsData.find(b => b.id === boostId); if (boost && boost.isActive) { boost.isActive = false; boost.timeoutId = null; boost.remainingTime = 0; renderBoosts(); updateDisplay(); } }
        function updateBoostTimers(deltaTimeMs) { boostsData.forEach(boost => { if (boost.isActive) { boost.remainingTime -= deltaTimeMs; const timerElement = document.querySelector(`.boost-option[data-boost-id="${boost.id}"] .boost-timer`); if (timerElement) { timerElement.innerText = `${_('boostActiveLabel')} ${formatRemainingTime(boost.remainingTime)}`; } if (boost.remainingTime <= 0) { deactivateBoost(boost.id); } } }); }

        // --- Funkcja Rebirth ---
        function performRebirth() { if (!canRebirth()) { return; } if (confirm(_('messageConfirmRebirth'))) { const oldBonusPercent = Math.round((rebirthBonusCpsMultiplier - 1) * 100); score = 0; clickPower = 1; goldenClicksRemaining = 0; currentGoldenClickMultiplier = 1; buildingsData.forEach(b => b.count = 0); upgradesData.forEach(u => u.isBought = false); boostsData.forEach(boost => { if (boost.timeoutId) clearTimeout(boost.timeoutId); boost.isActive = false; boost.timeoutId = null; boost.remainingTime = 0; }); rebirthCount++; rebirthBonusCpsMultiplier = calculateRebirthBonusMultiplier(); const newBonusPercent = Math.round((rebirthBonusCpsMultiplier - 1) * 100); const gainedBonusPercent = newBonusPercent - oldBonusPercent; showMessage('messageRebirthComplete', 'purple', true, gainedBonusPercent); updateClickButtonAppearance(); updateDisplay(); renderBuildings(); renderUpgrades(); renderBoosts(); renderSkins(); saveGame(); } }

        // --- Funkcje Interfejsu Użytkownika ---
        function translateUI() { document.documentElement.lang = currentLanguage; document.querySelectorAll('[data-translate-key]').forEach(el => { const key = el.dataset.translateKey; const txt = _(key); if (el.placeholder) el.placeholder = txt; else if (el.tagName === 'TITLE') el.textContent = txt; else el.innerText = txt; }); document.getElementById('lang-pl').classList.toggle('active', currentLanguage === 'pl'); document.getElementById('lang-en').classList.toggle('active', currentLanguage === 'en'); renderBuildings(); renderUpgrades(); renderSkins(); renderBoosts(); updateDisplay(); }
        function updateDisplay() { if (!scoreDisplay || !cpsDisplay || !rebirthCountDisplay || !rebirthBonusDisplay || !rebirthButton) return; passiveProduction = calculateTotalCPS(); scoreDisplay.innerText = formatNumber(score); cpsDisplay.innerText = formatNumber(passiveProduction); rebirthCountDisplay.innerText = rebirthCount; rebirthBonusDisplay.innerText = `x${rebirthBonusCpsMultiplier.toFixed(2)}`; rebirthButton.disabled = !canRebirth(); buildingsData.forEach(b => { const div = document.getElementById(`building-${b.id}`); if (!div) return; const btn = div.querySelector('.buyButton'); const costSpan = div.querySelector('.building-cost'); const levelSpan = div.querySelector('.building-level'); levelSpan.innerText = b.count; if (b.count >= b.maxLevel) { btn.disabled = true; btn.classList.add('max-level'); btn.innerText = _('maxLevelLabel'); costSpan.innerText = '---'; } else { const cost = getBuildingCost(b); btn.disabled = score < cost; btn.classList.remove('max-level'); btn.innerText = `${_('buyButtonLabel')} (${formatNumber(Math.ceil(cost))})`; costSpan.innerText = formatNumber(Math.ceil(cost)); } }); upgradesData.forEach(u => { const div = document.getElementById(`upgrade-${u.id}`); if (!div) return; if (u.isBought) { div.style.display = 'none'; } else { const afford = score >= u.cost; const reqMet = checkRequirements(u); div.style.display = reqMet ? 'flex' : 'none'; if (reqMet) { const btn = div.querySelector('.buyButton'); btn.disabled = !afford; btn.innerText = `${_('buyButtonLabel')} (${formatNumber(u.cost)})`; } } }); skinsData.forEach(skin => { if (!skin.isUnlocked && skin.cost) { const buyButton = document.querySelector(`.skin-option[data-skin-id="${skin.id}"] .skin-buy-button`); if (buyButton) { buyButton.disabled = score < skin.cost; } } }); boostsData.forEach(boost => { const activateButton = document.querySelector(`.boost-option[data-boost-id="${boost.id}"] .boost-activate-button`); if (activateButton) { const currentCost = getBoostCost(boost); activateButton.disabled = score < currentCost || (boost.effect?.type === 'goldenClicks' && goldenClicksRemaining > 0) || boost.isActive; } }); }
        function renderBuildings() { if (!buildingsListDiv) return; buildingsListDiv.innerHTML = ''; buildingsData.forEach(b => { const div = document.createElement('div'); div.className = 'building'; div.id = `building-${b.id}`; let costText = '---'; let buttonText = _('maxLevelLabel'); let buttonDisabled = true; let buttonClass = 'max-level'; if (b.count < b.maxLevel) { const cost = getBuildingCost(b); costText = formatNumber(Math.ceil(cost)); buttonText = `${_('buyButtonLabel')} (${costText})`; buttonDisabled = false; buttonClass = ''; } div.innerHTML = `<div><h3>${_(b.nameKey)}</h3><p>${_('levelLabel')}: <span class="building-level">${b.count}</span>/${b.maxLevel}</p><p>${_('costLabel')}: <span class="building-cost">${costText}</span></p><p>${_('productionLabel')}: ${formatNumber(b.baseProduction)}</p></div><button class="buyButton ${buttonClass}" data-building-id="${b.id}" ${buttonDisabled ? 'disabled' : ''}>${buttonText}</button>`; buildingsListDiv.appendChild(div); }); buildingsListDiv.querySelectorAll('.buyButton:not(.max-level)').forEach(btn => btn.addEventListener('click', () => buyBuilding(btn.dataset.buildingId))); }
        function renderUpgrades() { if (!upgradesListDiv) return; upgradesListDiv.innerHTML = ''; upgradesData.forEach(u => { const div = document.createElement('div'); div.className = 'upgrade'; div.id = `upgrade-${u.id}`; div.style.display = 'none'; div.innerHTML = `<div><h3>${_(u.nameKey)}</h3><p>${_('costLabel')}: <span class="upgrade-cost">${formatNumber(u.cost)}</span></p></div><button class="buyButton" data-upgrade-id="${u.id}">${_('buyButtonLabel')} (${formatNumber(u.cost)})</button>`; upgradesListDiv.appendChild(div); }); upgradesListDiv.querySelectorAll('.buyButton').forEach(btn => btn.addEventListener('click', () => buyUpgrade(btn.dataset.upgradeId))); }
        function renderSkins() { if (!skinsSelectionContainer) return; skinsSelectionContainer.innerHTML = ''; skinsData.forEach(skin => { const div = document.createElement('div'); div.classList.add('skin-option'); div.dataset.skinId = skin.id; let contentHTML = `<h4>${_(skin.nameKey)}</h4><p>${_(skin.descKey)}</p>`; if (skin.effectKey) { contentHTML += `<p class="skin-effect"><em>${_('effectLabel')}: ${_(skin.effectKey)}</em></p>`; } if (skin.isUnlocked) { div.classList.remove('locked'); if (skin.id === currentSkinId) { div.classList.add('active-skin'); } div.addEventListener('click', () => selectSkin(skin.id)); } else { div.classList.add('locked'); if (skin.cost) { contentHTML += `<p class="skin-cost">${_('costLabel')}: ${formatNumber(skin.cost)}</p>`; contentHTML += `<button class="skin-buy-button" data-skin-id="${skin.id}" ${score < skin.cost ? 'disabled' : ''}>${_('skinBuyButtonLabel')}</button>`; } } div.innerHTML = contentHTML; skinsSelectionContainer.appendChild(div); }); skinsSelectionContainer.querySelectorAll('.skin-buy-button').forEach(button => { button.addEventListener('click', (event) => { event.stopPropagation(); buySkin(button.dataset.skinId); }); }); }
        function renderBoosts() { // Zaktualizowano, aby pokazywać dynamiczny koszt i stan Lucky Click
            if (!boostsListContainer) return; boostsListContainer.innerHTML = ''; boostsData.forEach(boost => { const div = document.createElement('div'); div.classList.add('boost-option'); div.dataset.boostId = boost.id; let contentHTML = `<h4>${_(boost.nameKey)}</h4><p>${_(boost.descKey)}</p><p class="boost-duration">${_(boost.durationKey)}</p>`; const currentCost = getBoostCost(boost); const isLuckyClick = boost.effect?.type === 'goldenClicks'; const isLuckyClickActive = isLuckyClick && goldenClicksRemaining > 0; if (boost.isActive && !isLuckyClick) { /* Timed boosts */ div.classList.add('boost-active'); contentHTML += `<p class="boost-timer">${_('boostActiveLabel')} ${formatRemainingTime(boost.remainingTime)}</p>`; } else if (isLuckyClickActive) { /* Lucky Clicks active */ div.classList.add('boost-active'); contentHTML += `<p class="boost-timer">${_('boostActiveLabel')} ${goldenClicksRemaining} ${_('boostRemainingClicksLabel', goldenClicksRemaining)}</p>`; } else { /* Inactive boosts */ div.classList.remove('boost-active'); contentHTML += `<p class="boost-cost">${_('costLabel')}: ${formatNumber(currentCost)}</p>`; const disableButton = score < currentCost || (isLuckyClick && goldenClicksRemaining > 0); contentHTML += `<button class="boost-activate-button" data-boost-id="${boost.id}" ${disableButton ? 'disabled' : ''}>${_('boostActivateButtonLabel')}</button>`; } div.innerHTML = contentHTML; boostsListContainer.appendChild(div); }); boostsListContainer.querySelectorAll('.boost-activate-button').forEach(button => { button.addEventListener('click', () => { activateBoost(button.dataset.boostId); }); });
        }
        function selectSkin(skinId) { const skin = skinsData.find(s => s.id === skinId); if (!skin || !skin.isUnlocked) { if(skin && !skin.isUnlocked) { showMessage('messageSkinSelectLocked', 'orange'); } return; } if (currentSkinId === skinId) return; currentSkinId = skinId; applySkin(skinId); renderSkins(); updateDisplay(); showMessage('messageSkinSelected', 'green', true, _(skin.nameKey)); saveGame(); }
        function applySkin(skinId) { const skin = skinsData.find(s => s.id === skinId); if (!skin) return; skinsData.forEach(s => document.body.classList.remove(s.cssClass)); document.body.classList.add(skin.cssClass); }
        function gameLoop() { const interval = 100; setInterval(() => { passiveProduction = calculateTotalCPS(); if (passiveProduction > 0) score += passiveProduction * (interval / 1000); updateBoostTimers(interval); if (document.visibilityState === 'visible') updateDisplay(); }, interval); setInterval(() => { saveGame(); showMessage('messageGameSavedAuto', 'green'); }, 60000); }
        function updateClickButtonAppearance() { if (!clickButton) return; if (goldenClicksRemaining > 0) { clickButton.classList.add('lucky-click-active'); clickButton.innerText = `${_('clickButton')} (${goldenClicksRemaining}!)`; } else { clickButton.classList.remove('lucky-click-active'); clickButton.innerText = _('clickButton'); } }

        // --- Zapis/Odczyt ---
        function saveGame() { const gameState = { score: score, clickPower: clickPower, language: currentLanguage, skinId: currentSkinId, rebirthCount: rebirthCount, lastSaveTime: Date.now(), savedCPS: calculateTotalCPS(true, false), buildings: buildingsData.map(b => ({ id: b.id, count: b.count })), upgrades: upgradesData.map(u => ({ id: u.id, isBought: u.isBought })), skins: skinsData.map(s => ({ id: s.id, isUnlocked: s.isUnlocked })), }; localStorage.setItem('megaClickerSaveExtreme', JSON.stringify(gameState)); }
        function loadGame() { const savedState = localStorage.getItem('megaClickerSaveExtreme'); let loadedLang = 'pl'; let loadedSkin = 'default'; let offlineGained = 0; skinsData.forEach(skin => { if(skin.cost !== null) skin.isUnlocked = false; }); boostsData.forEach(boost => { boost.isActive = false; boost.timeoutId = null; boost.remainingTime = 0; }); goldenClicksRemaining = 0; currentGoldenClickMultiplier = 1; rebirthCount = 0; if (savedState) { const gameState = JSON.parse(savedState); score = gameState.score || 0; clickPower = gameState.clickPower || 1; loadedLang = gameState.language || 'pl'; loadedSkin = gameState.skinId || 'default'; rebirthCount = gameState.rebirthCount || 0; if (gameState.buildings) { buildingsData.forEach(b => b.count = 0); gameState.buildings.forEach(sb => { const b = buildingsData.find(x => x.id === sb.id); if (b) b.count = sb.count; }); } if (gameState.upgrades) { upgradesData.forEach(u => u.isBought = false); gameState.upgrades.forEach(su => { const u = upgradesData.find(x => x.id === su.id); if (u) u.isBought = su.isBought; }); } if (gameState.skins) { gameState.skins.forEach(savedSkin => { const skin = skinsData.find(s => s.id === savedSkin.id); if (skin) { skin.isUnlocked = savedSkin.isUnlocked; } }); } rebirthBonusCpsMultiplier = calculateRebirthBonusMultiplier(); const lastSaveTime = gameState.lastSaveTime; const savedCPS = gameState.savedCPS || 0; if (lastSaveTime && savedCPS > 0) { const currentTime = Date.now(); const timeDiffSeconds = Math.floor((currentTime - lastSaveTime) / 1000); const offlineTimeSeconds = Math.min(timeDiffSeconds, MAX_OFFLINE_TIME_SECONDS); if (offlineTimeSeconds > 10) { offlineGained = offlineTimeSeconds * savedCPS * rebirthBonusCpsMultiplier; score += offlineGained; const timeFormatted = formatOfflineTime(offlineTimeSeconds); showMessage('messageOfflineProgress', 'blue', true, timeFormatted.hours, timeFormatted.minutes, timeFormatted.seconds, formatNumber(offlineGained)); } } if (offlineGained === 0) { showMessage('messageGameLoaded', 'green'); } console.log("Game loaded!"); } else { loadedLang = localStorage.getItem('megaClickerLanguage') || 'pl'; loadedSkin = localStorage.getItem('megaClickerSkin') || 'default'; rebirthBonusCpsMultiplier = calculateRebirthBonusMultiplier(); showMessage('messageNoSaveData', 'orange'); console.log("No save data found."); } setLanguage(loadedLang, false); applySkin(loadedSkin); currentSkinId = loadedSkin; renderBuildings(); renderUpgrades(); renderSkins(); renderBoosts(); updateDisplay(); updateClickButtonAppearance(); }
        function resetGame() { if (confirm(_('messageConfirmReset'))) { localStorage.removeItem('megaClickerSaveExtreme'); window.location.reload(); } }
        function showMessage(keyOrText, color, isKey = true, ...args) { if (!messageArea) return; const msg = isKey ? _(keyOrText, ...args) : keyOrText; messageArea.innerText = msg; messageArea.style.color = color; setTimeout(() => { if (messageArea.innerText === msg) messageArea.innerText = ''; }, 5000); }

        // --- Konsola Admina ---
        function setupAdminConsoleListeners() { if (!openConsoleButton || !consoleDiv || !consolePasswordInput || !consoleOpenBtn || !closeConsoleBtn || !consoleCommandsDiv || !commandInput || !executeCommandBtn || !maxAllBtn || !consoleHelpOverlay || !closeHelpOverlayBtn) { console.error("Brak elementów konsoli!"); return; } openConsoleButton.addEventListener('click', () => { consolePasswordInput.value = ''; consoleCommandsDiv.style.display = 'none'; consolePasswordInput.style.display = 'inline-block'; consoleOpenBtn.style.display = 'inline-block'; consoleHelpOverlay.style.display = 'none'; consoleDiv.style.display = 'block'; }); consoleOpenBtn.addEventListener('click', () => { if (consolePasswordInput.value === adminPassword) { consolePasswordInput.style.display = 'none'; consoleOpenBtn.style.display = 'none'; consoleCommandsDiv.style.display = 'block'; commandInput.value = ''; showMessage('consoleUnlocked', 'green'); } else { showMessage('consoleInvalidPassword', 'red'); consolePasswordInput.value = ''; } }); closeConsoleBtn.addEventListener('click', () => { consoleDiv.style.display = 'none'; consolePasswordInput.style.display = 'inline-block'; consoleOpenBtn.style.display = 'inline-block'; consoleCommandsDiv.style.display = 'none'; consoleHelpOverlay.style.display = 'none'; }); executeCommandBtn.addEventListener('click', () => { const commandString = commandInput.value.trim(); if (commandString) { processCommand(commandString); } }); commandInput.addEventListener('keypress', (event) => { if (event.key === 'Enter') { event.preventDefault(); executeCommandBtn.click(); } }); closeHelpOverlayBtn.addEventListener('click', () => { consoleHelpOverlay.style.display = 'none'; }); maxAllBtn.addEventListener('click', maxEverything); }
        function maxEverything() { if (!confirm("Na pewno chcesz zmaksymalizować wszystko?")) return; score += 1e50; upgradesData.forEach(u => { if(!u.isBought) u.isBought = true; }); buildingsData.forEach(b => b.count = b.maxLevel); showMessage('consoleMaxAllComplete', 'green'); updateDisplay(); renderBuildings(); renderUpgrades(); renderSkins(); renderBoosts(); saveGame(); }
        function processCommand(commandString) { const parts = commandString.toLowerCase().split(' '); const command = parts[0]; const p1=parts[1]; const p2=parts[2]; const p3=parseInt(parts[3]); let msgKey = 'consoleCmdUnknown'; let msgArgs = [command]; let color = 'red'; let shouldSave = true; if (command === 'help') { if (consoleHelpText && consoleHelpOverlay) { consoleHelpText.innerText = _('consoleCmdHelp'); consoleHelpOverlay.style.display = 'block'; } else { console.error("Brak elementów pomocy!"); } commandInput.value = ''; return; } try { switch (command) { case 'add': if (p1 === 'score' && p2 !== undefined && !isNaN(parseFloat(p2)) && parseFloat(p2) >= 0) { const a = parseFloat(p2); score += a; msgKey = 'consoleCmdAddedScore'; msgArgs = [formatNumber(a)]; color = 'green'; } else if (p1 === 'building' && p2 && p3 !== undefined && !isNaN(p3) && p3 >= 0) { const id = p2, a = p3; const b = buildingsData.find(x => x.id === id); if (b) { const amountToAdd = Math.min(a, b.maxLevel - b.count); if (amountToAdd > 0) { b.count += amountToAdd; msgKey = 'consoleCmdAddedBuilding'; msgArgs = [amountToAdd, _(b.nameKey)]; color = 'green'; } else { msgKey = 'messageBuildingMaxLevel'; msgArgs = [_(b.nameKey)]; color = 'orange'; shouldSave = false;} } else { msgKey = 'consoleCmdBuildingNotFound'; msgArgs = [id]; shouldSave = false; } } else if (p1 === 'upgrade' && p2) { const id = p2; const u = upgradesData.find(x => x.id === id); if (u && !u.isBought) { u.isBought = true; msgKey = 'consoleCmdUpgradeBought'; msgArgs = [_(u.nameKey)]; color = 'green'; } else if (u && u.isBought) { msgKey = 'consoleCmdUpgradeAlreadyBought'; msgArgs = [_(u.nameKey)]; color = 'orange'; shouldSave = false;} else { msgKey = 'consoleCmdUpgradeNotFound'; msgArgs = [id]; shouldSave = false;} } else { msgKey = 'consoleCmdInvalidAdd'; msgArgs = []; shouldSave = false; } break; case 'set': if (p1 === 'score' && p2 !== undefined && !isNaN(parseFloat(p2)) && parseFloat(p2) >= 0) { const a = parseFloat(p2); score = a; msgKey = 'consoleCmdScoreSet'; msgArgs = [formatNumber(a)]; color = 'green'; } else { msgKey = 'consoleCmdInvalidSet'; msgArgs = []; shouldSave = false; } break; default: shouldSave = false; break; } } catch (e) { console.error("Cmd error:", e); msgKey = 'consoleCmdError'; msgArgs = []; shouldSave = false; } commandInput.value = ''; if(msgKey) showMessage(msgKey, color, true, ...msgArgs); updateDisplay(); renderBuildings(); renderUpgrades(); renderSkins(); renderBoosts(); if(shouldSave) saveGame(); }

        // --- Język ---
        function setLanguage(lang, save = true) { if (translations[lang]) { currentLanguage = lang; if (save) localStorage.setItem('megaClickerLanguage', lang); translateUI(); } }

        // --- Inicjalizacja ---
        function initializeGame() { console.log("Init..."); cacheDOMElements(); const langPlBtn = document.getElementById('lang-pl'); const langEnBtn = document.getElementById('lang-en'); if (langPlBtn) langPlBtn.addEventListener('click', () => setLanguage('pl')); if (langEnBtn) langEnBtn.addEventListener('click', () => setLanguage('en')); if (rebirthButton) rebirthButton.addEventListener('click', performRebirth); loadGame(); gameLoop(); if (clickButton) clickButton.addEventListener('click', click); if (saveGameButton) saveGameButton.addEventListener('click', saveGame); if (loadGameButton) loadGameButton.addEventListener('click', loadGame); if (resetButton) resetButton.addEventListener('click', resetGame); setupAdminConsoleListeners(); console.log("Ready."); }

        // --- Start ---
        document.addEventListener('DOMContentLoaded', initializeGame);

    </script>
</body>
</html>